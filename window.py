#!/usr/bin/python
### OSFingerprint by Window
### Yeudiel Hernandez Torres
### PBSI 11G


from scapy.all import *
import re

if len(sys.argv) != 3:
	print "Error. Ejemplo: window >ip> <port>\n"
	exit(0)

ip = sys.argv[1]
port = sys.argv[2]

try:
	#creamos y enviamos el pack
	pack = IP(dst=ip)/TCP(dport=int(port),flags="S") 
	ans = str(sr(pack, verbose=False)[0][0])

	window = re.search(r"window=(\d+) ", ans)
	print "\n\nWindow = %s " % window.group(1)
	print "El host %s puede ser:" % ip

	if window.group(1) == "5720":
		print "Android\n"
	elif window.group(1) == "5840":
		print "Linux\n"
	elif window.group(1) == "8192":
		print "Windows 7, 8, 10\n"
	elif window.group(1) == "29200":
		print "Linux\n"
	elif window.group(1) == "65535":
		print "win2 XP\n"
	else:
		print "N/A"

except:
	print "\n\nNo se pudo determinar el Sistema Operativo. Verifica que el puerto este abierto"
